(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4808:function(e,t,s){Promise.resolve().then(s.bind(s,6753))},3844:function(e,t,s){"use strict";s.d(t,{Z:function(){return u}});var n=s(7437),o=s(2265),a=s(6548),r=s(8655),i=s(5870),l=s(8467),d=s(1444),c=s(1996);function u(e){let{postdetails:t}=e,{allPosts:s,isLoading:u,isError:m,userPosts:p}=(0,d.v9)(e=>e.posts),[h,x]=o.useState(null),f=(0,d.I0)(),[g,j]=o.useState(null),Z=!!g,v=()=>{j(null)};return(0,n.jsxs)("div",{children:[(0,n.jsx)(a.Z,{id:"demo-positioned-button","aria-controls":Z?"demo-positioned-menu":void 0,"aria-haspopup":"true","aria-expanded":Z?"true":void 0,onClick:e=>{j(e.currentTarget)},className:"hover",children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(l.Z,{})})}),(0,n.jsxs)(r.Z,{className:"hover",id:"demo-positioned-menu","aria-labelledby":"demo-positioned-button",anchorEl:g,open:Z,onClose:v,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:[(0,n.jsx)(i.Z,{onClick:()=>{v(),f((0,c.bs)(t._id))},children:"Delete"}),(0,n.jsx)(i.Z,{onClick:v,children:"Edit"})]})]})}},6753:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return A}});var n=s(7437),o=s(1444),a=s(1996),r=s(2265),i=s(8024),l=s(270),d=s(7573),c=s(4037),u=s(4696),m=s(2879),p=s(9216),h=s(5349),x=s(335),f=s(511),g=s(8713),j=s(9678),Z=s(8125),v=s(1326),y=s(3844),b=s(6548),C=s(2862),k=s(1096),w=s(8784),P=s(385),E=s(3269),S=s(824),_=s(3866),I=s(6463);function T(e){let{postData:t}=e,s=(0,I.useRouter)(),i=(0,o.I0)(),{allPosts:l,isLoading:d,isError:c}=(0,o.v9)(e=>e.posts);async function u(e){var n;e.preventDefault();let o=null===(n=e.currentTarget)||void 0===n?void 0:n.content.value,r=t._id;console.log("postData:",t),console.log("postData._id:",t._id),await i((0,a.Ir)({content:o,post:r})),s.refresh(),h()}let[m,p]=r.useState(!1),h=()=>{p(!1)};return(0,n.jsxs)(r.Fragment,{children:[(0,n.jsx)(b.Z,{className:"hov",sx:{backgroundColor:"transparent"},onClick:()=>{p(!0)},startIcon:(0,n.jsx)(_.Z,{})}),(0,n.jsxs)(k.Z,{open:m,onClose:h,PaperProps:{component:"form",onSubmit:u},children:[(0,n.jsx)(S.Z,{sx:{fontWeight:"bold"},children:"Add Comment"}),(0,n.jsxs)(P.Z,{children:[(0,n.jsx)(E.Z,{children:"Enteract with people on Facebook timelin to have good experience"}),(0,n.jsx)(C.Z,{autoFocus:!0,required:!0,margin:"dense",id:"name",name:"content",label:"Comment",type:"text",fullWidth:!0,variant:"standard"})]}),(0,n.jsxs)(w.Z,{children:[(0,n.jsx)(b.Z,{onClick:h,children:"Cancel"}),(0,n.jsx)(b.Z,{type:"submit",children:"add"})]})]})]})}var L=s(7883);let D=(0,i.ZP)(e=>{let{expand:t,...s}=e;return(0,n.jsx)(x.Z,{...s})})(e=>{let{theme:t,expand:s}=e;return{transform:s?"rotate(180deg)":"rotate(0deg)",marginLeft:"auto",transition:t.transitions.create("transform",{duration:t.transitions.duration.shortest})}});function N(e){var t,s;let{postdetails:i}=e,b=(0,o.I0)(),{allPosts:C,comments:k}=(0,o.v9)(e=>e.posts),[w,P]=r.useState(!1),E=()=>{P(!w)};return(0,n.jsxs)(l.Z,{sx:{maxWidth:345},children:[(0,n.jsx)(d.Z,{avatar:(0,n.jsx)(h.Z,{src:null==i?void 0:null===(t=i.user)||void 0===t?void 0:t.photo,sx:{bgcolor:g.Z[500]},"aria-label":""}),action:(0,n.jsx)(x.Z,{"aria-label":"settings",children:(0,n.jsx)(y.Z,{})}),title:null==i?void 0:null===(s=i.user)||void 0===s?void 0:s.name,subheader:"September 14, 2016"}),(0,n.jsx)(c.Z,{component:"img",height:"194",image:null==i?void 0:i.image,alt:"Paella dish"}),(0,n.jsx)(u.Z,{children:(0,n.jsx)(f.Z,{variant:"body2",color:"text.secondary",children:null==i?void 0:i.body})}),(0,n.jsxs)(m.Z,{disableSpacing:!0,children:[(0,n.jsx)(x.Z,{"aria-label":"add to favorites",children:(0,n.jsx)(j.Z,{})}),(0,n.jsx)(x.Z,{"aria-label":"add comment",children:(0,n.jsx)(v.Z,{children:(0,n.jsx)(T,{postData:i})})}),(0,n.jsx)(D,{expand:w,onClick:()=>{b((0,a.aP)(i._id)),E()},"aria-expanded":w,"aria-label":"show more",children:(0,n.jsx)(Z.Z,{})})]}),(0,n.jsx)(p.Z,{in:w,timeout:"auto",unmountOnExit:!0,children:(0,n.jsx)(u.Z,{children:null==k?void 0:k.map(e=>(0,n.jsxs)(v.Z,{className:"comment",children:[(0,n.jsxs)(v.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,n.jsx)(h.Z,{src:e.commentCreator.photo,sx:{bgcolor:g.Z[500],width:"30px",height:"30px"},"aria-label":"recipe"}),(0,n.jsx)("h5",{style:{marginLeft:"2px"},children:e.commentCreator.name})]}),(0,n.jsxs)(v.Z,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,n.jsx)(f.Z,{paragraph:!0,sx:{margin:"5px"},children:e.content}),(0,n.jsx)(L.Z,{sx:{cursor:"pointer"}})]})]},e._id))})})]})}var O=s(8433),F=s(468);function A(){let e=(0,I.useRouter)(),t=(0,o.I0)(),{count:s}=(0,o.v9)(e=>e.counter),{allPosts:i,isLoading:l,isError:d}=(0,o.v9)(e=>e.posts),{userData:c}=(0,o.v9)(e=>e.users);return(0,r.useEffect)(()=>{t((0,a.Bd)())},[t]),localStorage.getItem("userToken")||e.push("/login"),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(v.Z,{children:l?(0,n.jsx)("h4",{style:{textAlign:"center",padding:"50px 0px"},children:(0,n.jsx)(F.Z,{})}):(0,n.jsx)(O.ZP,{container:!0,rowSpacing:2,columnSpacing:{xs:1,sm:2,md:0},justifyContent:"center",alignItems:"center",className:"grid",children:null==i?void 0:i.map(e=>(0,n.jsx)(O.ZP,{item:!0,xs:4,children:(0,n.jsx)(N,{postdetails:e,userDetalis:c})},e._id))})})})}},1996:function(e,t,s){"use strict";s.d(t,{$D:function(){return p},$u:function(){return m},Bd:function(){return r},Ir:function(){return c},aP:function(){return u},bs:function(){return l},q2:function(){return i},ww:function(){return d}});var n=s(9753);let o={token:localStorage.getItem("userToken"),"Content-Type":"application/json"},a={token:localStorage.getItem("userToken"),"Content-Type":"application/json"},r=(0,n.hg)("posts/getAllPosts",async()=>{let e=await fetch("https://linked-posts.routemisr.com/posts?limit=50",{method:"GET",headers:o}),t=await e.json();return console.log(t),t}),i=(0,n.hg)("posts/addPost",async e=>{let t=await fetch("https://linked-posts.routemisr.com/posts",{body:e,method:"POST",headers:o});return await t.json()}),l=(0,n.hg)("posts/removepost",async e=>{let t=await fetch("https://linked-posts.routemisr.com/posts/".concat(e),{method:"DELETE",headers:a});return await t.json()}),d=(0,n.hg)("posts/getUserPosts",async e=>{let t=await fetch("https://linked-posts.routemisr.com/users/".concat(e,"/posts?limit=4"),{headers:o});return await t.json()}),c=(0,n.hg)("posts/addComment",async e=>{let t=await fetch("https://linked-posts.routemisr.com/comments",{body:JSON.stringify(e),method:"POST",headers:a});return await t.json()}),u=(0,n.hg)("posts/getUserComments",async e=>{let t=await fetch("https://linked-posts.routemisr.com/posts/".concat(e,"/comments"),{headers:o});return await t.json()}),m=(0,n.hg)("posts/removecomment",async e=>{let t=await fetch("https://linked-posts.routemisr.com/comments/".concat(e),{method:"DELETE",headers:a});return await t.json()}),p=(0,n.oM)({name:"posts",initialState:{allPosts:[],userPosts:[],isLoading:!0,isError:null,comments:[]},extraReducers:e=>{e.addCase(r.fulfilled,(e,t)=>{e.isLoading=!1,e.allPosts=t.payload.posts}),e.addCase(r.pending,(e,t)=>{e.isLoading=!0}),e.addCase(i.fulfilled,(e,t)=>{console.log("added"),e.isLoading=!1,e.allPosts.push(t.payload)}),e.addCase(l.fulfilled,(e,t)=>{console.log("removed"),e.userPosts=e.userPosts.filter(e=>e._id!==t.payload.id)}),e.addCase(u.fulfilled,(e,t)=>{e.comments=t.payload.comments}),e.addCase(d.fulfilled,(e,t)=>{e.isLoading=!1,e.userPosts=t.payload.posts}),e.addCase(c.fulfilled,(e,t)=>{e.isLoading=!1}),e.addCase(m.fulfilled,(e,t)=>{console.log(t.payload),e.comments=e.comments.filter(e=>e._id!==t.payload.id)})},reducers:{}}).reducer}},function(e){e.O(0,[444,753,355,871,91,645,382,420,971,23,744],function(){return e(e.s=4808)}),_N_E=e.O()}]);