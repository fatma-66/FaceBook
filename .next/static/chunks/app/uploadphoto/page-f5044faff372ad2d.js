(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[525],{3282:function(e,t,s){Promise.resolve().then(s.bind(s,1550))},6463:function(e,t,s){"use strict";var o=s(1169);s.o(o,"useRouter")&&s.d(t,{useRouter:function(){return o.useRouter}}),s.o(o,"useServerInsertedHTML")&&s.d(t,{useServerInsertedHTML:function(){return o.useServerInsertedHTML}})},1550:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return i}});var o=s(7437),r=s(2265),n=s(1444),a=s(6463),u=s(6101),l=s(6648);function i(){let[e,t]=(0,r.useState)(null),[s,i]=(0,r.useState)(null),{allPosts:d,isLoading:c,isError:g}=(0,n.v9)(e=>e.posts),{userData:p}=(0,n.v9)(e=>e.users),m=(0,a.useRouter)(),f=(0,n.I0)(),[h,y]=(0,r.useState)(null);async function v(e){var t;e.preventDefault();let s=new FormData,o=null===(t=e.currentTarget)||void 0===t?void 0:t.photo.files[0];s.append("photo",o),"fulfilled"===(await f((0,u.zv)(s))).meta.requestStatus&&(await f((0,u.OA)()),m.push("/"))}return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("form",{onSubmit:v,style:{width:"80%",margin:"10px auto"},children:[h&&(0,o.jsx)(l.default,{src:h,alt:"Image Preview",style:{maxWidth:"100%",marginTop:"10px",border:"1px solid rgba(0,0,0,0.5)"}}),(0,o.jsx)("input",{type:"file",className:"btn",name:"photo",onChange:function(e){var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(s){let e=new FileReader;e.onloadend=()=>{y(e.result)},e.readAsDataURL(s)}else y(null)}}),(0,o.jsx)("button",{type:"submit",className:"btn",style:{cursor:"pointer"},children:"Upload image"})]})})}},6101:function(e,t,s){"use strict";s.d(t,{M_:function(){return n},OA:function(){return l},cA:function(){return i},n$:function(){return a},zv:function(){return u}});var o=s(9753);let r={token:localStorage.getItem("userToken")},n=(0,o.hg)("users/getUserDetails",async e=>{let t=await fetch("https://linked-posts.routemisr.com/users/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()}),a=(0,o.hg)("users/userLogin",async e=>{let t=await fetch("https://linked-posts.routemisr.com/users/signin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),s=await t.json();return console.log(s),s}),u=(0,o.hg)("users/UploadImage",async e=>{let t=await fetch("https://linked-posts.routemisr.com/users/upload-photo",{method:"PATCH",headers:r,body:e}),s=await t.json();return console.log(s),s}),l=(0,o.hg)("users/getLoggedUserData",async()=>{let e=await fetch("https://linked-posts.routemisr.com/users/profile-data",{headers:r});return await e.json()}),i=(0,o.oM)({name:"users",initialState:{loggedin:!0,message:"",userData:[],loggedmessage:"",registermessok:"",registermessnot:"",loginmessok:"",loginmessnot:""},extraReducers:e=>{e.addCase(n.fulfilled,(e,t)=>{e.registermessok=t.payload.message,e.registermessnot=t.payload.error}),e.addCase(a.fulfilled,(e,t)=>{console.log("Logged"),e.loginmessok=t.payload.message,e.loginmessnot=t.payload.error,t.payload&&t.payload&&t.payload.token&&localStorage.setItem("userToken",t.payload.token)}),e.addCase(a.rejected,(e,t)=>{console.log("Not Logged"),e.loggedmessage=null==t?void 0:t.payload.error}),e.addCase(l.fulfilled,(e,t)=>{e.userData=t.payload.user})},reducers:{}}).reducer}},function(e){e.O(0,[444,753,648,971,23,744],function(){return e(e.s=3282)}),_N_E=e.O()}]);