(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{9923:function(e,t,o){Promise.resolve().then(o.bind(o,5560))},5560:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return M}});var s=o(7437),n=o(1034),a=o.n(n);o(3054);var r=o(1444),l=o(9753);let i=(0,l.oM)({name:"counter",initialState:{count:0},reducers:{increase:(e,t)=>{e.count+=t.payload},decrease:()=>{console.log("increase")}}}),d=i.reducer,{increase:c,decrease:u}=i.actions;var p=o(1996),m=o(6101);let h=(0,l.oM)({name:"userdata",initialState:{user:{id:"",name:"",photo:""},isLoading:!1,isError:null},reducers:{updateUserProfileImage:(e,t)=>{let{userId:o,photo:s}=t.payload;e.user.id===o&&(e.user.photo=s)}}}),{updateUserProfileImage:g}=h.actions,f=h.reducer,x=(0,l.xC)({reducer:{counter:d,posts:p.$D,users:m.cA,userdata:f}});var y=o(2265),k=o(1733),j=o(1326),w=o(9806),C=o(335),S=o(511),v=o(8655),T=o(9504),Z=o(2197),b=o(5349),O=o(6548),P=o(888),E=o(5870),I=o(6463);function L(){let{userData:e}=(0,r.v9)(e=>e.users),t=[{name:"Home",path:"/"},{name:"Profile",path:"/profile"}],o=(0,I.useRouter)(),n=(0,r.I0)(),[a,l]=y.useState(!!localStorage.getItem("userToken")),[i,d]=y.useState(null),[c,u]=y.useState(null),p=()=>{d(null)},h=()=>{u(null)},g=e=>{"/login"===e?(localStorage.removeItem("userToken"),l(!1),o.push("/login"),o.prefetch):o.push(e),h()};y.useEffect(()=>{localStorage.getItem("userToken")&&n((0,m.OA)())},[n]);let f=e=>{"/login"===e?(localStorage.removeItem("userToken"),l(!1),o.push("/")):o.push(e),p()};return(0,s.jsx)(k.Z,{sx:{boxShadow:"none"},position:"static",children:(0,s.jsx)(Z.Z,{maxWidth:"xl",children:(0,s.jsxs)(w.Z,{disableGutters:!0,children:[(0,s.jsx)(S.Z,{variant:"h6",noWrap:!0,component:"a",href:"#app-bar-with-responsive-menu",sx:{mr:2,display:{xs:"none",md:"flex"},fontFamily:"monospace",fontWeight:700,letterSpacing:".3rem",color:"inherit",textDecoration:"none"},children:"FACEBOOK"}),(0,s.jsxs)(j.Z,{sx:{flexGrow:1,display:{xs:"flex",md:"none"}},children:[(0,s.jsx)(C.Z,{size:"large","aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:e=>{d(e.currentTarget)},color:"inherit",children:(0,s.jsx)(T.Z,{})}),(0,s.jsx)(v.Z,{id:"menu-appbar",anchorEl:i,anchorOrigin:{vertical:"bottom",horizontal:"left"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"left"},open:!!i,onClose:p,sx:{display:{xs:"block",md:"none"}},children:t.map(e=>(0,s.jsx)(E.Z,{onClick:()=>f(e.path),children:(0,s.jsx)(S.Z,{textAlign:"center",children:e.name})},e.name))})]}),(0,s.jsx)(S.Z,{variant:"h5",noWrap:!0,component:"a",href:"#app-bar-with-responsive-menu",sx:{mr:2,display:{xs:"flex",md:"none"},flexGrow:1,fontFamily:"monospace",fontWeight:700,letterSpacing:".3rem",color:"inherit",textDecoration:"none"},children:"FACEBOOk"}),localStorage.getItem("userToken")?(0,s.jsx)(j.Z,{sx:{flexGrow:1,display:{xs:"none",md:"flex"}},children:t.map(e=>(0,s.jsx)(O.Z,{onClick:()=>f(e.path),sx:{my:2,color:"white",display:"block"},children:e.name},e.name))}):null,localStorage.getItem("userToken")?(0,s.jsxs)(j.Z,{sx:{flexGrow:0},children:[(0,s.jsx)(P.Z,{title:"Open settings",children:(0,s.jsx)(C.Z,{onClick:e=>{u(e.currentTarget)},sx:{p:0},children:(0,s.jsx)(b.Z,{alt:"Remy Sharp",src:null==e?void 0:e.photo})})}),(0,s.jsx)(v.Z,{sx:{mt:"45px"},id:"menu-appbar",anchorEl:c,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:!!c,onClose:h,children:[{name:"Profile",path:"/profile"},{name:"Add post",path:"/addpost"},{name:"Upload photo",path:"/uploadphoto"},{name:"logout",path:"/login"}].map(e=>(0,s.jsx)(E.Z,{onClick:()=>g(e.path),children:(0,s.jsx)(S.Z,{textAlign:"center",children:e.name})},e.name))})]}):null]})})})}var A=o(7623),D=o(1705),N=o(1568),_=o.n(N);let z=(0,o(9257).Z)({typography:{fontFamily:_().style.fontFamily},palette:{primary:{main:"#000"}}});function M(e){let{children:t}=e;return(0,s.jsx)("html",{lang:"en",children:(0,s.jsx)(A.Z,{children:(0,s.jsx)(D.Z,{theme:z,children:(0,s.jsx)(r.zt,{store:x,children:(0,s.jsxs)("body",{className:a().className,children:[(0,s.jsx)(L,{}),t]})})})})})}},1996:function(e,t,o){"use strict";o.d(t,{$D:function(){return m},$u:function(){return p},Bd:function(){return r},Ir:function(){return c},aP:function(){return u},bs:function(){return i},q2:function(){return l},ww:function(){return d}});var s=o(9753);let n={token:localStorage.getItem("userToken"),"Content-Type":"application/json"},a={token:localStorage.getItem("userToken"),"Content-Type":"application/json"},r=(0,s.hg)("posts/getAllPosts",async()=>{let e=await fetch("https://linked-posts.routemisr.com/posts?limit=50",{method:"GET",headers:n}),t=await e.json();return console.log(t),t}),l=(0,s.hg)("posts/addPost",async e=>{let t=await fetch("https://linked-posts.routemisr.com/posts",{body:e,method:"POST",headers:n});return await t.json()}),i=(0,s.hg)("posts/removepost",async e=>{let t=await fetch("https://linked-posts.routemisr.com/posts/".concat(e),{method:"DELETE",headers:a});return await t.json()}),d=(0,s.hg)("posts/getUserPosts",async e=>{let t=await fetch("https://linked-posts.routemisr.com/users/".concat(e,"/posts?limit=4"),{headers:n});return await t.json()}),c=(0,s.hg)("posts/addComment",async e=>{let t=await fetch("https://linked-posts.routemisr.com/comments",{body:JSON.stringify(e),method:"POST",headers:a});return await t.json()}),u=(0,s.hg)("posts/getUserComments",async e=>{let t=await fetch("https://linked-posts.routemisr.com/posts/".concat(e,"/comments"),{headers:n});return await t.json()}),p=(0,s.hg)("posts/removecomment",async e=>{let t=await fetch("https://linked-posts.routemisr.com/comments/".concat(e),{method:"DELETE",headers:a});return await t.json()}),m=(0,s.oM)({name:"posts",initialState:{allPosts:[],userPosts:[],isLoading:!0,isError:null,comments:[]},extraReducers:e=>{e.addCase(r.fulfilled,(e,t)=>{e.isLoading=!1,e.allPosts=t.payload.posts}),e.addCase(r.pending,(e,t)=>{e.isLoading=!0}),e.addCase(l.fulfilled,(e,t)=>{console.log("added"),e.isLoading=!1,e.allPosts.push(t.payload)}),e.addCase(i.fulfilled,(e,t)=>{console.log("removed"),e.userPosts=e.userPosts.filter(e=>e._id!==t.payload.id)}),e.addCase(u.fulfilled,(e,t)=>{e.comments=t.payload.comments}),e.addCase(d.fulfilled,(e,t)=>{e.isLoading=!1,e.userPosts=t.payload.posts}),e.addCase(c.fulfilled,(e,t)=>{e.isLoading=!1}),e.addCase(p.fulfilled,(e,t)=>{console.log(t.payload),e.comments=e.comments.filter(e=>e._id!==t.payload.id)})},reducers:{}}).reducer},6101:function(e,t,o){"use strict";o.d(t,{M_:function(){return a},OA:function(){return i},cA:function(){return d},n$:function(){return r},zv:function(){return l}});var s=o(9753);let n={token:localStorage.getItem("userToken")},a=(0,s.hg)("users/getUserDetails",async e=>{let t=await fetch("https://linked-posts.routemisr.com/users/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()}),r=(0,s.hg)("users/userLogin",async e=>{let t=await fetch("https://linked-posts.routemisr.com/users/signin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),o=await t.json();return console.log(o),o}),l=(0,s.hg)("users/UploadImage",async e=>{let t=await fetch("https://linked-posts.routemisr.com/users/upload-photo",{method:"PATCH",headers:n,body:e}),o=await t.json();return console.log(o),o}),i=(0,s.hg)("users/getLoggedUserData",async()=>{let e=await fetch("https://linked-posts.routemisr.com/users/profile-data",{headers:n});return await e.json()}),d=(0,s.oM)({name:"users",initialState:{loggedin:!0,message:"",userData:[],loggedmessage:"",registermessok:"",registermessnot:"",loginmessok:"",loginmessnot:""},extraReducers:e=>{e.addCase(a.fulfilled,(e,t)=>{e.registermessok=t.payload.message,e.registermessnot=t.payload.error}),e.addCase(r.fulfilled,(e,t)=>{console.log("Logged"),e.loginmessok=t.payload.message,e.loginmessnot=t.payload.error,t.payload&&t.payload&&t.payload.token&&localStorage.setItem("userToken",t.payload.token)}),e.addCase(r.rejected,(e,t)=>{console.log("Not Logged"),e.loggedmessage=null==t?void 0:t.payload.error}),e.addCase(i.fulfilled,(e,t)=>{e.userData=t.payload.user})},reducers:{}}).reducer},3054:function(){}},function(e){e.O(0,[553,444,753,355,91,645,198,971,23,744],function(){return e(e.s=9923)}),_N_E=e.O()}]);